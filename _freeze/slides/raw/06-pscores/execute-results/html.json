{
  "hash": "4678cd8b0eaeb273c66375a328d02bbc",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Propensity Scores\"\nauthor: \"Lucy D'Agostino McGowan\"\ninstitute: \"Wake Forest University\"\nformat: \"kakashi-revealjs\"\n---\n\n## Observational Studies {background-color=\"#23373B\"}\n\n\n\n![](img/obs-studies-3.png)\n\n## {background-color=\"#23373B\"}\n\n![](img/trt.png)\n\n## {background-color=\"#23373B\"}\n\n![](img/trt-conf.png)\n\n## Confounding {background-color=\"#23373B\"}\n\n\n![](img/conf-2.png)\n\n\n## Confounding {background-color=\"#23373B\"}\n\n![](img/conf-3.png)\n\n## Propensity scores\n\nRosenbaum and Rubin showed in observational studies, conditioning on **propensity scores** can lead to unbiased estimates of the exposure effect\n\n1. There are no unmeasured confounders\n2. Every subject has a nonzero probability of receiving either exposure\n\n## Propensity scores\n\n* Fit a **logistic regression** predicting exposure using known covariates\n\n::: {.fragment}\n$$Pr(exposure = 1) = \\frac{1}{1+\\exp(-X\\beta)}$$\n:::\n\n* Each individuals' predicted values are the **propensity scores**\n\n## Propensity scores\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(broom)\n```\n:::\n\n\n## Propensity scores\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglm(\n  exposure ~ confounder_1 + confounder_2 + confounder_3 + ..., \n  data = df,\n  family = binomial()\n)\n```\n:::\n\n\n---\n\n## Propensity scores\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code  code-line-numbers=\"|6\"}\nglm(\n  exposure ~ confounder_1 + confounder_2 + confounder_3 + ..., \n  data = df,\n  family = binomial()\n) |>\n  augment(type.predict = \"response\", data = df) \n```\n:::\n\n\n## Propensity scores {background-color=\"#23373B\"}\n\n![](img/pscores.png)\n\n## Example: The Seven Dwarfs Mine Train {.small}\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n<img src=\"img/Mickey_and_Walt_Disney.jpg\" height=\"300\"></img>\n\nPhoto by Anna [CC-BY-SA-4.0](https://creativecommons.org/licenses/by-sa/4.0/deed.en)\n:::\n\n::: {.column width=\"50%\"}\nHistorically, guests who stayed in a Walt Disney World resort hotel were able to access the park during \"Extra Magic Hours\" during which the park was closed to all other guests.\n\nThese extra hours could be in the morning or evening.  \n\nThe Seven Dwarfs Mine Train is a ride at Walt Disney World's Magic Kingdom. Typically, each day Magic Kingdom may or may not be selected to have these \"Extra Magic Hours\".\n:::\n\n::::\n\n## {background-color=\"#23373B\" .large .center}\n\n*We are interested in examining the relationship between whether there were* **\"Extra Magic Hours\"** *in the morning and* **the average wait time** *for the Seven Dwarfs Mine Train the same day between 9am and 10am.*\n\n---\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](06-pscores_files/figure-revealjs/unnamed-chunk-5-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n## *Your turn*\n\n`<div class=\"countdown\" id=\"timer_1338d950\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">06</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>`{=html}\n\n### Using the confounders identified in the previous DAG, fit a propensity score model for `park_extra_magic_morning`\n\n### *Stretch*: Create two histograms, one of the propensity scores for days with extra morning magic hours and one for those without\n\n\n\n",
    "supporting": [
      "06-pscores_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"06-pscores_files/libs/countdown-0.4.0/countdown.css\" rel=\"stylesheet\" />\n<script src=\"06-pscores_files/libs/countdown-0.4.0/countdown.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}